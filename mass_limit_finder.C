#include "Math/Functor.h"
#include "Math/RootFinder.h"
#include "TGraph.h"

// stat only
// double zprime[] = {0.92652615934352611, 1.3858477712607136, 1.831461453982796, 1.8684315507916478, 1.5746754632277002, 0.94649850490907805, 0.81210413621233679, 0.70874615510230299, 0.67829364661762015, 0.50710284028598407, 0.20859634470837313, 0.14723588888274658, 0.15764961082046697, 0.1506071809647348, 0.099937283957819825, 0.059831321401321969, 0.051183206725084612, 0.05929916149877245};
// double s8[] = {1.7562838810774182, 0.97077453117913115, 1.8666877012159138, 2.0789487052306175, 1.8169383583316452, 1.1460055013707291, 0.60379530871442544, 0.25730474270399428, 0.21697924303837737, 0.17263439679200299, 0.09673741810239557, 0.062425600974874075, 0.050042186811111951, 0.038114471002579697, 0.022685750424262654, 0.012713202400776757, 0.0093504498036110825, 0.0087320273559754226};

// syst+stat expected
// double zprime[] = {2.4128233739176261, 1.8520718617312519, 1.534798108701751, 1.3519140680452373, 1.0141263123179245, 0.87547367045603042, 0.67944012972603918, 0.56706766579098711, 0.46695425955807285, 0.38586186598011502, 0.30376911284711422, 0.26208545137738859, 0.19876765661700826, 0.17169824178819681, 0.13768159623847132, 0.10806572103360754, 0.086739791604905747, 0.072894738634892778};
// double s8[] = {4.066688186453975, 2.8404397248675708, 2.0547983972111985, 1.447415070869192, 1.0406370758181591, 0.75239383082265798, 0.49954361199283337, 0.3583234093940541, 0.25348220821815537, 0.1797972390782, 0.12559407446163037, 0.089990701507548579, 0.062496460314657727, 0.045777197868142334, 0.031670889805528214, 0.024495621874452644, 0.016877006894845011, 0.011547064305684989};

// syst+stat
double zprime[] = {0.85872758845553587, 1.2213878276805894, 1.6519856233796841, 1.5600172546535693, 1.396764351848347, 0.93041197346088556, 0.73428766440996918, 0.62826144218926883, 0.58252076205875492, 0.41486128401827765, 0.20724362124459383, 0.13992214588293181, 0.12196626800989152, 0.12293512177627711, 0.094925923976138318, 0.059968123427735706, 0.045113597752314917, 0.040618926141885343};
double s8[] = {1.6143350467221504, 0.87282479421822035, 1.505338547801913, 1.7557154635950638, 1.5860051236410881, 1.0348499479152431, 0.56115615992547085, 0.25324840052283976, 0.19509916560890028, 0.15953106785529325, 0.091961601530559961, 0.058892981204915047, 0.044391595596429183, 0.03392965955934104, 0.021611361320230511, 0.012571193155643996, 0.0084067941464927663, 0.0063586945511759961};


double m[] = {1000.0, 1100.0, 1200.0, 1300.0, 1400.0, 1500.0, 1600.0, 1700.0, 1800.0, 1900.0, 2000.0, 2100.0, 2200.0, 2300.0, 2400.0, 2500.0, 2600.0, 2700.0};

TGraph *g_zprime = new TGraph(18,m,zprime);
TGraph *g_s8 = new TGraph(18,m,s8);


double func_Zprime(double x) {
   return g_zprime->Eval(x)-1.;
}

double func_S8(double x) {
   return g_s8->Eval(x)-1.;
}


int NumericalRootFinder()
{

   // RootFinder with Base Functions
   ROOT::Math::Functor1D f_Zprime(&func_Zprime);
   ROOT::Math::Functor1D f_S8(&func_S8);

   ROOT::Math::RootFinder rfbis(ROOT::Math::RootFinder::kGSL_BISECTION );
   rfbis.SetFunction(f_Zprime, 1200, 1600.);
   rfbis.Solve();
   cout << rfbis.Root() << endl;

   return 0;
}
